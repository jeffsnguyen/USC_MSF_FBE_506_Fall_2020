---
title: "assignment08"
author: "Jeff Nguyen"
date: "23/10/2020"
output: html_document
---


```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, envir=.GlobalEnv)
```

**University of Southern California**  
**Marshall School of Business**  
**FBE 506 Quantitative Method in Finance**

Assignment 07  
Student Name: Ngoc Son (Jeff) Nguyen  
Student ID: 6524885309  


# **Question 1**  

The minimum variance solution is:  

\begin{equation}
  \begin{aligned}
    f(w) &= w^2 * \sigma_1^2 + (1 - w)^2 * \sigma_2^2 + 2 * w * (1-w) * \sigma_12  \\
    \text{where}  \\
    w &= \text{weight of stock 1}  \\
    \sigma_1 &= \text{standard deviation of stock 1's returns}  \\
    \sigma_2 &= \text{standard deviation of stock 2's returns}  \\
    \sigma_{12} &= \text{covariance of stock 1 and 2's returns}  \\
  \end{aligned}
\end{equation}

We know the correlation coefficient $r$ between $r_1$ and $r_2$ to be: $r = \frac{\sigma_{12}}{\sigma_1*\sigma2}$.

Rewrite the variance of the portfolio as:  

\begin{equation}
  \begin{aligned}
    f(w) &= w^2*\sigma_1^2 + (1 - w)^2*\sigma_2^2 + 2 * w * (1-w) * r * \sigma_1 * \sigma_2  \\
  \end{aligned}
\end{equation}

**Since minimum variance is the objective, $r=-1$ yields the lowest $f(w)$, ceteris paribus. Thus the answer is b.**  

# **Question 2**  

```{r}
library(quantmod)

# Set start date and end date of data
start_date <- "2018-01-02"
end_date <- "2020-10-23"

# Get data for JPM, FB and the 10 year T-bill (TNX)
getSymbols("JPM", src = "yahoo", from = start_date, to = end_date)
getSymbols("WMT", src = "yahoo", from = start_date, to = end_date)
getSymbols("AAPL", src = "yahoo", from = start_date, to = end_date)

# Get adjusted returns data for 01/2014
rJPM <- diff(log(to.monthly(JPM)$JPM.Adjusted))
rWMT <- diff(log(to.monthly(WMT)$WMT.Adjusted))
rAAPL <- diff(log(to.monthly(AAPL)$AAPL.Adjusted))

# Calculate statistics
mean_rJPM <- mean(rJPM, na.rm = TRUE)
mean_rWMT <- mean(rWMT, na.rm = TRUE)
mean_rAAPL <- mean(rAAPL, na.rm = TRUE)

sd_rJPM <- sd(rJPM, na.rm = TRUE)
sd_rWMT <- sd(rWMT, na.rm = TRUE)
sd_rAAPL <- sd(rAAPL, na.rm = TRUE)

# Generate monthly returns DataFrame, excluding NA
# Note that in this case, excess returns is equal returns
returnsDF <- data.frame(rJPM, rWMT, rAAPL)[-1,]
excess_returnsDF <- returnsDF
vcovMatrix <- matrix(c(cov(returnsDF)), nrow=3, ncol=3, byrow=TRUE)  # Create the variance-covariance matrix of returns of 3 stocks

# Name the columns of vcovMatrix
assetNames <- c("JPM", "WMT", "AAPL")
dimnames(vcovMatrix) <- list(assetNames, assetNames)

# Average returns, excess returns matrix
avg_returnsDF <- matrix(colMeans(returnsDF, na.rm=TRUE))
avg_excess_returnsDF <- matrix(colMeans(excess_returnsDF, na.rm=TRUE))

# Optimum portfolio
zOptimum <- solve(vcovMatrix, avg_excess_returnsDF)  # z-values
wOptimum <- zOptimum / sum(zOptimum)  # Weights
dimnames(wOptimum) <- list(assetNames, "Weights")

# Optimum Portfolio statistics
rOptimum <- t(wOptimum) %*% avg_returnsDF   # Optimum returns
varOptimum <- t(wOptimum) %*% vcovMatrix %*% wOptimum  # Optimum variance
sdOptimum <- varOptimum^.5
stats_portfolioOptimum <- matrix(c(rOptimum, varOptimum, sdOptimum), nrow=3)  # Create a view of the statistics
dimnames(stats_portfolioOptimum) <- list(c("Returns", "Variance", "Stdev"), "Optimum Portfolio")

```

The variance-covariance matrix is:  
```{r}
vcovMatrix
```

The optimum weights are:
```{r}
wOptimum
```

The returns and risk of the optimum portfolio are:
```{r}
stats_portfolioOptimum
```

# **Question 3**  

\begin{equation}
  \begin{aligned}
    X & = \begin{pmatrix} 2 & 6 & 1 \end{pmatrix} \\
    Z & = \begin{pmatrix} 5 & 3 & 2 \\ 3 & 6 & 1 \\ 2 & 1 & 9 \end{pmatrix} \\
  \end{aligned}
\end{equation}

## a. Show that Z is a symmetric matrix  

Z is symmetrical iff. $Z = Z'$ 

\begin{equation}
  \begin{aligned}
    Z' & = \begin{pmatrix} 5 & 3 & 2 \\ 3 & 6 & 1 \\ 2 & 1 & 9 \end{pmatrix} \\
  \end{aligned}
\end{equation}

**We can see $Z = Z'$. Thus Z is symmetrical.**  

## b. Find inverse of matrix Z.  
```{r}
library(matlib)

zMatrix <- matrix(c(5, 3, 2, 3, 6, 1, 2, 1, 9), 3, 3, byrow=TRUE)
z_invMatrix <- inv(zMatrix)
dimnames(z_invMatrix) <- list(c('','',''), c('','',''))
z_invMatrix

det(zMatrix)
det(z_invMatrix)
```
Thus:
\begin{equation}
  \begin{aligned}
    Z^{-1} & = \begin{pmatrix} 0.30813953 & -0.14534884 & -0.05232558 \\ 
                              -0.14534884 & 0.23837209 & 0.00581395 \\ 
                              -0.05232558 & 0.00581395  & 0.12209302 \end{pmatrix} \\
  \end{aligned}
\end{equation}

## c. Find determinants of Z and Z inverse. Show that they are equal to each other.  

\begin{equation}
  \begin{aligned}
    det(Z) & = 5\begin{vmatrix} 6 & 1 \\ 1 & 9 \end{vmatrix} - 
               3\begin{vmatrix} 3 & 1 \\ 2 & 9 \end{vmatrix} + 
               2\begin{vmatrix} 3 & 6 \\ 2 & 1 \end{vmatrix} \\
           & = 5(6*9 - 1*1) - 3(3*9 - 2*1) + 2(3*1-6*2) \\
           & = `r 5*(6*9 - 1*1) - 3*(3*9 - 2*1) + 2*(3*1-6*2)` \\
    \text{additionally,} \\
    det(Z^{-1}) & = 0.30813953\begin{vmatrix} 0.23837209 & 0.00581395 \\ 0.00581395 & 0.12209302 \end{vmatrix} + 
                    0.14534884\begin{vmatrix} -0.14534884 & 0.00581395 \\  -0.05232558 & 0.12209302 \end{vmatrix} - 
                    0.05232558\begin{vmatrix} -0.14534884 & 0.23837209 \\ -0.05232558 & 0.00581395 \end{vmatrix} \\
           & = 0.30813953*(0.23837209*0.12209302 - 0.00581395*0.00581395) + 
               0.14534884*(-0.14534884*0.12209302 - -0.05232558*0.00581395) - 
               0.05232558*(-0.14534884*0.00581395--0.05232558*0.23837209) \\
           & = `r 0.30813953*(0.23837209*0.12209302 - 0.00581395*0.00581395) + 0.14534884*(-0.14534884*0.12209302 - -0.05232558*0.00581395) -                        0.05232558*(-0.14534884*0.00581395--0.05232558*0.23837209)`
  \end{aligned}
\end{equation}

They are not equal. Not sure what you mean?

## d. Find Xâ€™ZX.  
Non comformable multiplication. You are asking to do this multiplication (3x1)*(3x3)*(1*3) which is mathematically impossible.  

## e. Find $Z^{-1}X'$.  
\begin{equation}
  \begin{aligned}
    Z^{-1}X & = \begin{pmatrix} 0.30813953 & -0.14534884 & -0.05232558 \\ 
                               -0.14534884 & 0.23837209 & 0.00581395 \\ 
                               -0.05232558 & 0.00581395  & 0.12209302 \end{pmatrix} * \begin{pmatrix} 2 \\ 6 \\ 1 \end{pmatrix} \\
            & = \begin{pmatrix} 2*0.30813953 + 6*-0.14534884 + 1*-0.05232558 \\
                                2*-0.14534884 + 6*0.23837209 + 1*0.00581395 \\ 
                                2*-0.05232558 + 6*0.00581395 + 1*0.12209302 \end{pmatrix} \\
            & = \begin{pmatrix} `r 2*0.30813953 + 6*-0.14534884 + 1*-0.05232558` \\
                                `r 2*-0.14534884 + 6*0.23837209 + 1*0.00581395` \\ 
                                `r 2*-0.05232558 + 6*0.00581395 + 1*0.12209302` \end{pmatrix} \\               
  \end{aligned}
\end{equation}

## f. Find eigenvalues and eigenvectors of Z using R or Excel.
Eigenvalues using R:  
```{r}
ev <- eigen(zMatrix)
ev$values
```

Eigenvectos:
```{r}
ev$vectors
```

Using R, we see the corresponding eigenvectors:  
\begin{equation}
  \begin{aligned}
    \begin{pmatrix} -0.4840709 \\ -0.4503380 \\ -0.7502473 \end{pmatrix} \\
    \begin{pmatrix} -0.3863934 \\ -0.6592664 \\ 0.6450333 \end{pmatrix}  \\
    \begin{pmatrix} 0.7850958 \\ -0.6021325 \\ -0.1451241 \end{pmatrix}  \\
  \end{aligned}
\end{equation}